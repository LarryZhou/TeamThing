<!DOCTYPE html>

<html>
<head>
	<title>Team</title>
</head>
<body>

<div data-role="view" id="vwTeam" data-title="Team Things" data-show="initTeamView">
     <ul id="lstTeamThings" class="things">      	
     </ul>
     <ul data-role="actionsheet" id="thingStar" data-open="onOpenStarActionSheet">	
        <li class="km-actionsheet-title">Star:</li>	            
        <li id="btnStarThing"><a data-action="starItem">Star</a></li>
        <li id="btnUnStarThing"><a data-action="unstarItem">Unstar</a></li>	         
     </ul>
     <div id="msgNoThings" style="width: 250px;text-align:center;margin: 50px auto;display: none;">
     	<h2>Your team is lazy.</h2>
     	<p>
     	There are no things from your team members.
     	</p>
     </div>
     <div id="msgNoTeam" style="width: 250px;text-align:center;margin: 50px auto;display: none;">
     	<h2>You are a team of one.</h2>
     	<p>
     	If you add members to your team, you'll see their things here. Teams are good.
     	</p>
     </div>
</div>

<script type="text/x-kendo-template" id="tmplTeamThingItem">		
		<a href="\\#thingStar" 
            data-actionsheet-context="#:data.id#;#:data.isStarred#"
            data-rel="actionsheet">	
			[STAR]
		</a>
		<div class="thingTitle">#= data.description #</div>
</script>

<script>
    function initTeamView() {
        //Hide Add button on main index view
        $(".btnAdd").css("visibility", "hidden");

		var ele = $("#lstTeamThings"),
			tmpl = kendo.template($("#tmplTeamThingItem").html()),
			app = teamThingApp;
		
		if(app.getTeamSize() <= 1){
			$("#msgNoTeam").show();
		}else{
			//Load things being done by your team members	
			teamThingApp.loadTeamView(tmpl,ele);
		}		
	}

	function onOpenStarActionSheet(args){
		var container = args.sender.element,
        	contextArgs = args.context.split(";"),
			isStarred = contextArgs[1],
        	id = contextArgs[0];

        if(isStarred){
        	$(container).children("#btnUnStarThing").show();
        	$(container).children("#btnStarThing").hide();
        }else{
        	$(container).children("#btnUnStarThing").hide();
        	$(container).children("#btnStarThing").show();
        }
	}

	function starItem(args){
		//TODO
		var id = args.context.split(";")[0];
	}

	function unstarItem(args){
		//TODO
		var id = args.context.split(";")[0];
	}
</script>
</body>
</html>